CREATE DATABASE IF NOT EXISTS AULA_2_MYSQL;

USE AULA_2_MYSQL;

CREATE TABLE IF NOT EXISTS AULA_2_MYSQL_DETAILS(
COD INT(5) NOT NULL,
NOME VARCHAR(30) NOT NULL,
GENDER VARCHAR(1),
AGE INT(5),
EMAIL VARCHAR(50),
PHONE VARCHAR(11),
FEE DECIMAL(6,2)
);

ALTER TABLE aula_2_mysql_details RENAME TO STUDENTS_DETAILS;

CREATE TABLE IF NOT EXISTS STATES(
STATE_ID INT(2) NOT NULL AUTO_INCREMENT PRIMARY KEY,
STATE VARCHAR(2) NOT NULL
);

CREATE TABLE IF NOT EXISTS COURSES(
COURSE_ID VARCHAR(3) NOT NULL,
NAME VARCHAR(30) NOT NULL,
TIME INT(2) NOT NULL
);

SET AUTOCOMMIT=0;

SET AUTOCOMMIT=1;

CREATE TABLE IF NOT EXISTS COUNTRIES(
ID INT(2) NOT NULL PRIMARY KEY AUTO_INCREMENT,
INITIALS VARCHAR(2) NOT NULL
);

SELECT * FROM COUNTRIES;

INSERT INTO COUNTRIES (INITIALS) VALUES ('BR');
COMMIT; -- DADO ESTÁ SALVO, DEPOIS DO COMMIT NÃO PODE MAIS SER ALTERADO--

INSERT INTO COUNTRIES (INITIALS) VALUES ('FR');
ROLLBACK; -- DESFAZ ALGO FEITO---

SET GLOBAL LOCAL_INFILE = TRUE;

LOAD DATA INFILE 'C:\\temp\\states.csv' INTO TABLE STATES FIELDS TERMINATED BY ';' ENCLOSED BY '"'LINES TERMINATED BY '\n';

LOAD DATA INFILE 'C:\\temp\\students.csv' INTO TABLE STUDENTS_DETAILS FIELDS TERMINATED BY ';' ENCLOSED BY '"' LINES TERMINATED BY '\n';

SELECT * FROM STATES;
SELECT * FROM COURSES;
SELECT * FROM COUNTRIES;

TRUNCATE TABLE STATES;

DELETE FROM STUDENTS_DETAILS WHERE COD = 0;

SELECT DISTINCT AGE FROM STUDENTS_DETAILS;

SELECT DISTINCT AGE FROM STUDENTS_DETAILS ORDER BY AGE;

SELECT DISTINCT AGE FROM STUDENTS_DETAILS ORDER BY AGE DESC;

SELECT GENDER, COUNT(GENDER) AS 'QUANTITY' FROM STUDENTS_DETAILS
GROUP BY GENDER;

SELECT GENDER, COUNT(GENDER) AS 'QUANTITY' FROM STUDENTS_DETAILS
GROUP BY GENDER ORDER BY QUANTITY DESC;

SELECT FEE FROM STUDENTS_DETAILS;

SELECT FEE, COUNT(NOME) FROM STUDENTS_DETAILS GROUP BY FEE;

SELECT FEE, COUNT(NOME) FROM STUDENTS_DETAILS GROUP BY FEE HAVING FEE <> 0;

UPDATE STUDENTS_DETAILS SET
FEE = 250.55 WHERE COD = 44444;

SELECT FLOOR(FEE) FROM STUDENTS_DETAILS;

SELECT FEE, COUNT(NOME) FROM STUDENTS_DETAILS GROUP BY FLOOR(FEE) HAVING FLOOR(FEE) = 250;
